<?xml version="1.0" standalone="yes"?>
<beast>
	
	<taxa id="taxa">
		<taxon id="A"/>
		<taxon id="B"/>
		<taxon id="C"/>
	</taxa>
	
	<alignment id="alignment" dataType="nucleotide">
		<sequence> <taxon idref="A"/> N </sequence>
		<sequence> <taxon idref="B"/> N </sequence>
		<sequence> <taxon idref="C"/> N </sequence>		
	</alignment>
	
	<patterns id="patterns" strip="false">
		<alignment idref="alignment"/>
	</patterns>
	
	<newick id="tree">
		((A:1,B:1):1,C:2);
	</newick>
	
	<treeModel id="treeModel">
		<newick idref="tree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>
	
	<hkyModel id="hky">
	  <frequencies>
	    <frequencyModel dataType="nucleotide">
	      <frequencies>
		<parameter id="hky.frequencies" value="0.34 0.16 0.16 0.34"/>
	      </frequencies>
	    </frequencyModel>
	  </frequencies>
	  <kappa>
	    <parameter id="hky.kappa" value="2.0" lower="1.0E-8" upper="Infinity"/>
	  </kappa>
	</hkyModel>
	
	<siteModel id="siteModel">
	  <substitutionModel>
	    <hkyModel idref="hky"/>
	  </substitutionModel>
	  <mutationRate>
	    <parameter id="clock.rate"  value="10.0" lower="0.0" upper="10.0"/>
	  </mutationRate>
	</siteModel>	

	<markovJumpsTreeLikelihood id="treeLikelihood">
	  <patterns idref="patterns"/>
	  <treeModel idref="treeModel"/>
	  <siteModel idref="siteModel"/>
	  <hkyModel idref="hky"/>
	</markovJumpsTreeLikelihood>
	
	<parameter id="dummyParameter" value="1"/>
	
	<dummyModel id="dummyModel">
		<parameter idref="dummyParameter"/>
	</dummyModel>	
	
	<operators id="operators">
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="dummyParameter"/>
		</scaleOperator>
	</operators>
			
	<mcmc id="mcmc" chainLength="10000">
		<posterior id="posterior">
			<exponentialPrior offset="0.0" mean="1.0">
				<parameter idref="dummyParameter"/>
			</exponentialPrior>
			<dummyModel idref="dummyModel"/>		
			<markovJumpsTreeLikelihood idref="treeLikelihood"/>
		</posterior>
		<operators idref="operators"/>
		<log logEvery="1000">
			<posterior idref="posterior"/>
		</log>
		<logTree logEvery="1" nexusFormat="true" fileName="testMarkovJumps.trees">
			<treeModel idref="treeModel"/>
			<markovJumpsTreeLikelihood idref="treeLikelihood"/>
		</logTree>				
	</mcmc>

</beast>

<!--

java -cp build/dist/beast.jar dr.app.tools.TreeAnnotator -heights mean testMarkovJumps.trees markov.tree

-->