<?xml version="1.0" standalone="yes"?>
<beast>
	
	<taxa id="taxa">
		<taxon id="A"/>
		<taxon id="B"/>
		<!--<taxon id="C"/>-->
	</taxa>
	
	<alignment id="alignment" dataType="nucleotide">
		<sequence> <taxon idref="A"/> N </sequence>
		<sequence> <taxon idref="B"/> N </sequence>
		<!--<sequence> <taxon idref="C"/> N </sequence>		-->
	</alignment>
	
	<patterns id="patterns" strip="false">
		<alignment idref="alignment"/>
	</patterns>
	
	<newick id="tree">
		<!--((A:1,B:1):1,C:2);-->
        (A:1,B:1);
	</newick>
	
	<treeModel id="treeModel">
		<newick idref="tree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>
	
	<hkyModel id="hky">
	  <frequencies>
	    <frequencyModel dataType="nucleotide">
	      <frequencies>
		    <!--<parameter id="hky.frequencies" value="0.34 0.16 0.16 0.34"/>-->
              <parameter id="hky.frequencies" value="0.25 0.25 0.25 0.25"/>
	      </frequencies>
	    </frequencyModel>
	  </frequencies>
	  <kappa>
	    <parameter id="hky.kappa" value="1.0" lower="1.0E-8" upper="Infinity"/>
	  </kappa>
	</hkyModel>
	
	<siteModel id="siteModel">
	  <substitutionModel>
	    <hkyModel idref="hky"/>
	  </substitutionModel>
	  <mutationRate>
	    <parameter id="clock.rate"  value="0.03" lower="0.0" upper="10.0"/>
	  </mutationRate>
	</siteModel>	

	<markovJumpsTreeLikelihood id="treeLikelihood">
	  <patterns idref="patterns"/>
	  <treeModel idref="treeModel"/>
	  <siteModel idref="siteModel"/>
	  <hkyModel idref="hky"/>
	</markovJumpsTreeLikelihood>	
	
	<operators id="operators">
        <dirtyLikelihood weight="1">
            <treeLikelihood idref="treeLikelihood"/>
        </dirtyLikelihood>
	</operators>
			
	<mcmc id="mcmc" chainLength="10000">
		<posterior id="posterior">
			<treeLikelihood idref="treeLikelihood"/>
		</posterior>
		<operators idref="operators"/>
		<log logEvery="1000">
			<posterior idref="posterior"/>
		</log>
        <log logEvery="2" fileName="testMarkovJumps.log" >
            <treeLikelihood idref="treeLikelihood"/>
        </log>
		<logTree logEvery="1" nexusFormat="true" fileName="testMarkovJumps.trees">
			<treeModel idref="treeModel"/>
			<treeLikelihood idref="treeLikelihood"/>
		</logTree>				
	</mcmc>

    <traceAnalysis fileName="testMarkovJumps.log"/>

</beast>

<!--

java -cp build/dist/beast.jar dr.app.tools.TreeAnnotator -heights mean testMarkovJumps.trees markov.tree

-->