<?xml version="1.0" standalone="yes"?>
<!-- $Id: testML.xml,v 1.2 2005/07/11 23:22:40 rambaut Exp $ -->
<!-- Tests the Yule model -->

<beast>

    <taxa id="taxa">
        <taxon id="tip1"/>
        <taxon id="tip2"/>
        <taxon id="tip3"/>
        <taxon id="tip4"/>
        <taxon id="tip5"/>
        <taxon id="tip6"/>
        <taxon id="tip7"/>
        <taxon id="tip8"/>
        <taxon id="tip9"/>
        <taxon id="tip10"/>
        <taxon id="tip11"/>
        <taxon id="tip12"/>
        <taxon id="tip13"/>
        <taxon id="tip14"/>
        <taxon id="tip15"/>
        <taxon id="tip16"/>
        <taxon id="tip17"/>
        <taxon id="tip18"/>
        <taxon id="tip19"/>
        <taxon id="tip20"/>
        <taxon id="tip21"/>
        <taxon id="tip22"/>
        <taxon id="tip23"/>
        <taxon id="tip24"/>
        <taxon id="tip25"/>
        <taxon id="tip26"/>
        <taxon id="tip27"/>
        <taxon id="tip28"/>
        <taxon id="tip29"/>
        <taxon id="tip30"/>
        <taxon id="tip31"/>
        <taxon id="tip32"/>
        <taxon id="tip33"/>
        <taxon id="tip34"/>
        <taxon id="tip35"/>
        <taxon id="tip36"/>
        <taxon id="tip37"/>
        <taxon id="tip38"/>
        <taxon id="tip39"/>
        <taxon id="tip40"/>
        <taxon id="tip41"/>
        <taxon id="tip42"/>
        <taxon id="tip43"/>
        <taxon id="tip44"/>
        <taxon id="tip45"/>
        <taxon id="tip46"/>
        <taxon id="tip47"/>
        <taxon id="tip48"/>
        <taxon id="tip49"/>
        <taxon id="tip50"/>
        <taxon id="tip51"/>
        <taxon id="tip52"/>
        <taxon id="tip53"/>
        <taxon id="tip54"/>
        <taxon id="tip55"/>
        <taxon id="tip56"/>
        <taxon id="tip57"/>
        <taxon id="tip58"/>
        <taxon id="tip59"/>
        <taxon id="tip60"/>
        <taxon id="tip61"/>
        <taxon id="tip62"/>
        <taxon id="tip63"/>
        <taxon id="tip64"/>
        <taxon id="tip65"/>
        <taxon id="tip66"/>
        <taxon id="tip67"/>
        <taxon id="tip68"/>
        <taxon id="tip69"/>
        <taxon id="tip70"/>
        <taxon id="tip71"/>
        <taxon id="tip72"/>
        <taxon id="tip73"/>
        <taxon id="tip74"/>
        <taxon id="tip75"/>
        <taxon id="tip76"/>
        <taxon id="tip77"/>
        <taxon id="tip78"/>
        <taxon id="tip79"/>
        <taxon id="tip80"/>
        <taxon id="tip81"/>
        <taxon id="tip82"/>
        <taxon id="tip83"/>
        <taxon id="tip84"/>
        <taxon id="tip85"/>
        <taxon id="tip86"/>
        <taxon id="tip87"/>
        <taxon id="tip88"/>
        <taxon id="tip89"/>
        <taxon id="tip90"/>
        <taxon id="tip91"/>
        <taxon id="tip92"/>
        <taxon id="tip93"/>
        <taxon id="tip94"/>
        <taxon id="tip95"/>
        <taxon id="tip96"/>
        <taxon id="tip97"/>
        <taxon id="tip98"/>
        <taxon id="tip99"/>
        <taxon id="tip100"/>
    </taxa>

    <!-- This is a single tree simulated under a pure-birth process with birth rate = 1.0 -->
    <newick id="simulatedTree">
(((((((tip1:0.51765537,tip2:0.51765537):1.88098913,(((((tip3:0.94723082,(((tip4:0.46306133,(tip5:0.02670646,tip6:0.02670646):0.43635488):0.08447266,tip7:0.54753399):0.21542859,tip8:0.76296258):0.18426824):0.45594776,((tip9:0.68205023,(tip10:0.59007096,tip11:0.59007096):0.09197927):0.58937991,(tip12:0.76225424,tip13:0.76225424):0.50917590):0.13174844):0.08173060,(((tip14:0.02976608,tip15:0.02976608):0.48301744,tip16:0.51278353):0.54763055,(tip17:0.19119167,tip18:0.19119167):0.86922240):0.42449510):0.38801157,(tip19:0.23143458,tip20:0.23143458):1.64148617):0.17409897,((tip21:0.77307129,tip22:0.77307129):0.53592813,(tip23:0.20506382,tip24:0.20506382):1.10393560):0.73802030):0.35162479):0.02576339,((((tip25:0.32121229,(tip26:0.26316428,tip27:0.26316428):0.05804801):0.38790941,((tip28:0.55540419,((tip29:0.16312003,tip30:0.16312003):0.23805451,(tip31:0.23407149,tip32:0.23407149):0.16710305):0.15422964):0.02567077,tip33:0.58107495):0.12804675):0.24478030,((tip34:0.39287305,(tip35:0.07451153,tip36:0.07451153):0.31836152):0.07606196,tip37:0.46893501):0.48496699):1.28185356,((tip38:0.11700487,tip39:0.11700487):1.15494323,(tip40:0.32525158,(tip41:0.25328469,tip42:0.25328469):0.07196689):0.94669652):0.96380746):0.18865234):0.01435280,((tip43:0.16405082,(tip44:0.12521601,tip45:0.12521601):0.03883481):1.97274828,((((tip46:0.10810447,tip47:0.10810447):0.01373482,(tip48:0.03886271,tip49:0.03886271):0.08297658):1.74483085,(((tip50:0.35445237,tip51:0.35445237):0.04023528,(tip52:0.33647442,tip53:0.33647442):0.05821323):0.39720559,tip54:0.79189324):1.07477689):0.14317274,((tip55:1.10878468,tip56:1.10878468):0.72463870,(tip57:1.71186984,((tip58:0.31573582,(tip59:0.10451436,tip60:0.10451436):0.21122146):0.68895435,tip61:1.00469017):0.70717967):0.12155354):0.17641950):0.12695622):0.30196160):0.19088215,((((tip62:0.11927843,tip63:0.11927843):1.02247763,(tip64:0.27784753,tip65:0.27784753):0.86390853):0.19806886,(((tip66:0.28163362,(tip67:0.25879192,tip68:0.25879192):0.02284169):0.06542158,tip69:0.34705520):0.50164795,(tip70:0.16952276,tip71:0.16952276):0.67918038):0.49112177):0.70577335,(tip72:0.90803885,((tip73:0.17255425,tip74:0.17255425):0.41229534,(tip75:0.43381310,tip76:0.43381310):0.15103650):0.32318926):1.13755941):0.58404458):0.17386559,(tip77:0.81837296,((tip78:0.32232690,(tip79:0.03151774,tip80:0.03151774):0.29080915):0.38924479,(tip81:0.14598846,tip82:0.14598846):0.56558323):0.10680127):1.98513547):0.26916839,((((tip83:0.09680581,tip84:0.09680581):1.28165424,(((tip85:0.03838730,tip86:0.03838730):0.38679910,tip87:0.42518640):0.15743136,((tip88:0.27265835,(tip89:0.15990353,tip90:0.15990353):0.11275482):0.29276037,((tip91:0.01698232,tip92:0.01698232):0.06633544,tip93:0.08331776):0.48210096):0.01719904):0.79584229):0.67359531,((tip94:1.57662904,((tip95:0.20006752,tip96:0.20006752):1.33100605,tip97:1.53107357):0.04555547):0.05654395,tip98:1.63317299):0.41888237):0.79951048,(tip99:0.53824568,tip100:0.53824568):2.31332016):0.22111098);
    </newick>

	<!-- A prior on the distribution node heights defined given                  -->
	<!-- a Yule speciation process (a pure birth process).                       -->
	<yuleModel id="yule" units="substitutions">
		<birthRate>
			<parameter id="yule.birthRate" value="1.0" lower="0.0" upper="1000000.0"/>
		</birthRate>
	</yuleModel>

    <treeModel id="treeModel">
        <tree idref="simulatedTree"/>
        <rootHeight>
            <parameter id="treeModel.rootHeight"/>
        </rootHeight>
        <nodeHeights internalNodes="true">
            <parameter id="treeModel.internalNodeHeights"/>
        </nodeHeights>
        <nodeHeights internalNodes="true" rootNode="true">
            <parameter id="treeModel.allInternalNodeHeights"/>
        </nodeHeights>
    </treeModel>

	<speciationLikelihood id="speciation">
		<model>
			<yuleModel idref="yule"/>
		</model>
		<speciesTree>
			<treeModel idref="treeModel"/>
		</speciesTree>
	</speciationLikelihood>

    <operators id="operators">
        <scaleOperator scaleFactor="0.75" weight="1">
            <parameter idref="yule.birthRate"/>
        </scaleOperator>
    </operators>

	<mcmc id="mcmc" chainLength="1000000" autoOptimize="true">
		<posterior id="posterior">
			<prior id="prior">
				<speciationLikelihood idref="speciation"/>
			</prior>
		</posterior>
		<operators idref="operators"/>
		<log id="screenLog" logEvery="10000">
			<column label="Birth Rate" sf="6" width="12">
				<parameter idref="yule.birthRate"/>
			</column>
			<column label="L(speciation)" dp="4" width="12">
				<speciationLikelihood idref="speciation"/>
			</column>
		</log>
		<log id="fileLog" logEvery="1000" fileName="testYulePrior.log">
			<posterior idref="posterior"/>
			<parameter idref="yule.birthRate"/>
		</log>
	</mcmc>

	<report>
		<property name="timer">
			<object idref="mcmc"/>
		</property>
	</report>
	
    <traceAnalysis fileName="testYulePrior.log" burnIn="100000">
        <expectation name="yule.birthRate" value="1.0"/>
    </traceAnalysis>

</beast>
