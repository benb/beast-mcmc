<?xml version="1.0" standalone="yes"?>
<beast>
	<taxa id="taxa">
		<taxon id="1">  <!-- Rana pipiens -->
			<attr name="size">1.911 6.022</attr>
		</taxon>
		<taxon id="2">  <!-- Chrysemys picta -->
			<attr name="size">1.030 5.022</attr>
		</taxon>
		<taxon id="3">  <!-- Iguana iguana -->
			<attr name="size">1.061 5.503</attr>
		</taxon>
		<taxon id="4">  <!-- Gekko sp. -->
			<attr name="size">0.940 5.696</attr>
		</taxon>
	</taxa>

    <matrixParameter id="dataIA">      <!-- indices are ordered by taxa-listing, matrix defined by its columns -->
        <parameter id="dataIA.col1" value="1 2 3 4"/>
        <parameter id="dataIA.col2" value="5 6 7 8"/>
        <parameter id="dataIA.col3" value="5 6 7 8"/>
        <parameter id="dataIA.col4" value="1 2 3 4"/>
    </matrixParameter>

    <newick id="dinosaurTree">
	    (1:3,(2:2,(3:1,4:1):1):1);
    </newick>

	<treeModel id="treeModel">
		<coalescentTree idref="dinosaurTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
		<nodeTraits rootNode="true" internalNodes="true" leafNodes="true" name="indicator">
			<parameter id="clusterIndicator"/>
		</nodeTraits>
        <nodeTraits rootNode="true" internalNodes="true" leafNodes="true" name="mean">
            <parameter id="clusterMean"/>
        </nodeTraits>
    </treeModel>

	<multivariateDiffusionModel id="diffusionModel">
		<precisionMatrix>
			<matrixParameter id="precisionMatrix">
				<parameter id="col1" value="5.0 1.5"/>
				<parameter id="col2" value="1.5 2.0"/>
			</matrixParameter>
		</precisionMatrix>
	</multivariateDiffusionModel>

	<multivariateWishartPrior id="precisionPrior" df="2">
		<scaleMatrix>
			<matrixParameter>
				<parameter value="1.0 0.0"/>
				<parameter value="0.0 1.0"/>
			</matrixParameter>
		</scaleMatrix>
		<data>
			<matrixParameter idref="precisionMatrix"/>
		</data>
	</multivariateWishartPrior>

	<inhibitionLikelihood id="traitLikelihood">
		<treeModel idref="treeModel"/>
        <matrixParameter idref="dataIA"/>
        <precision>
            <parameter id="precision" value="0.1"/>
        </precision>
    </inhibitionLikelihood>

    <report>
        lnP = <inhibitionLikelihood idref="traitLikelihood"/>
    </report>

    <!--
	 <operators id="operators">
	   <randomWalkOperator windowSize="1.0" weight="10">
	 <parameter idref="internalTraits"/>
	   </randomWalkOperator>

	   <randomWalkOperator windowSize="1.0" weight="20">
	 <parameter idref="leafTraits"/>
	 <updateIndex>
	   <parameter idref="missingTraitValues"/>
	 </updateIndex>
	   </randomWalkOperator>

	   <precisionGibbsOperator weight="2">
	 <treeModel idref="treeModel"/>
	 <matrixParameter idref="precisionMatrix"/>
	 <multivariateWishartPrior idref="precisionPrior"/>
	   </precisionGibbsOperator>

	   <randomWalkOperator windowSize="1.0" weight="1">
	 <parameter idref="rootTrait"/>
	   </randomWalkOperator>

	  <internalTraitGibbsOperator weight="10">
	 <treeModel idref="treeModel"/>
	 <multivariateDiffusionModel idref="diffusionModel"/>
	   </internalTraitGibbsOperator>
	 </operators>
 -->
	<correlation id="corStatistic" dimension1="1" dimension2="2">
		<matrixParameter idref="precisionMatrix"/>
	</correlation>
	<!--
		<mcmc id="mcmc" chainLength="1000000" autoOptimize="true">
		  <posterior id="posterior">
		<likelihood id="likelihood"
	`	  <inhibitionLikelihood idref="traitLikelihood"/>
		</likelihood>
		<prior id="prior">
		  <multivariateNormalPrior idref="rootPrior"/>
		</prior>
		  </posterior>
		  <operators idref="operators"/>
		  <log id="fileLog" logEvery="1000" fileName="testMultivariateTraits.log">
		<posterior idref="posterior"/>
			<matrixParameter idref="precisionMatrix"/>
		<parameter idref="allTraits"/>
		<correlation idref="corStatistic"/>
		  </log>
		</mcmc>

		<traceAnalysis fileName="testMultivariateTraits.log"/>
	  -->

</beast>
