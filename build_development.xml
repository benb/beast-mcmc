
<project name="BEAST_DEVELOPMENT" default="all" basedir=".">
	<description>
        Build file for BEAST
		$Id: build_development.xml,v 1.4 2006/05/25 21:47:46 rambaut Exp $
	</description>
	<!-- set global properties for this build -->
	<property name="src" location="src"/>
	<property name="build" location="build"/>
	<property name="lib" location="lib"/>
	<property name="dist" location="dist"/>

	<property environment="env"/>

	<target name="init">
		<!-- Create the time stamp -->
		<tstamp/>
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${build}"/>
		<mkdir dir="${dist}"/>
	</target>

	<target name="all"
		depends="compile-all"
		description="Build all run-time stuff">
	</target>

	<target name="compile-all"
		depends="compile-basic">
	</target>

	<target name="compile-basic" depends="init">
		<!-- Compile the java code from ${src} into ${build} -->
        <javac source="1.5" srcdir="${src}" destdir="${build}" classpath="${lib}/jebl-0.4.jar:${lib}/jdom.jar:${lib}/commons-math-1.1.jar">
			<include name="dr/app/beastdev/**"/>
			<include name="dr/app/beauti/**"/>
			<include name="dr/app/colouring/**"/>
			<include name="dr/app/tools/**"/>
			<include name="dr/app/util/**"/>
			<include name="dr/evolution/**"/>
			<include name="dr/evomodel/**"/>
			<include name="dr/evoxml/**"/>
			<include name="dr/inference/**"/>
			<include name="dr/gui/chart/**"/>
			<include name="dr/gui/tree/**"/>
			<include name="dr/math/**"/>
			<include name="dr/matrix/**"/>
			<include name="dr/stats/**"/>
			<include name="dr/util/**"/>
			<include name="dr/xml/**"/>
		</javac>
	</target>

	<target name="dist" depends="compile-all" description="generate the distribution">
		<!-- Create the distribution directory -->
		<mkdir dir="${dist}"/>

		<!-- Put everything in ${build} into the iseq-${DSTAMP}.jar file -->
		<jar jarfile="${dist}/beastdev.jar">
			<fileset dir="${build}" includes="**/*.class,*.properties"/>
			<manifest>
				<attribute name="Built-By" value="${user.name}"/>
				<attribute name="Main-Class" value="dr.app.beastdev.BeastMain"/>
			</manifest>
			<zipgroupfileset dir="${lib}" includes="**/*.jar"/>
		</jar>
	</target>


</project>
