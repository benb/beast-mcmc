<project basedir="." default="dist_tool" name="JAR_IND_TOOL">
	<description>
		Build individual tool from BEAST. It has to run BEAST firstly.
	    $Id: build_ind_tool.xml,v 1.0 2009/04/15 Walter Xie Exp $
	</description>

	<!-- set global properties for this build -->
	<property name="src" location="src" />
	<property name="build" location="bin" />
	<property name="lib" location="lib" />
	<property name="dist" location="bin/dist" />
	
	<property name="main_class" value="dr.app.tools.TreeAnnotator" />
		
	<property environment="env" />

	<target name="init">
		<echo message="${ant.project.name}: ${ant.file}" />
		<!-- <mkdir dir="${build}" /> -->
		<!-- <mkdir dir="${dist}" /> -->
	</target>

	<target name="clean">
		<delete dir="bin" />
	</target>
		
	<target name="dist_tool" description="Jar tree annotator">
		<!-- It has to run BEAST firstly to compile -->
		<mkdir dir="${dist}" />

		<jar jarfile="${dist}/treeannotator.jar">
			<manifest>
				<attribute name="Built-By" value="${user.name}" />
				<attribute name="Main-Class" value="${main_class}" />
			</manifest>
			<fileset dir="${build}">
				<include name="dr/app/beast/**/*.class" />	
				<include name="dr/app/util/**/*.class" />
				<include name="dr/app/tools/**/*.class" />
				<include name="dr/evolution/**/*.class" />
				<include name="dr/evomodel/**/*.class" />
				<include name="dr/evoxml/**/*.class" />
				<include name="dr/evomodelxml/**" />
				<include name="dr/exporters/**/*.class" />
				<include name="dr/gui/tree/**/*.class" />
				<include name="dr/inference/**/*.class" />
				<include name="dr/math/**/*.class" />
				<include name="dr/matrix/**/*.class" />
				<include name="dr/stats/**/*.class" />
				<include name="dr/util/**/*.class" />
				<include name="dr/xml/**/*.class" />
				<include name="org/virion/jam/**/*.class" />
			</fileset>
			<fileset dir="">
				<include name="images/*.png" />
			</fileset>
			<fileset dir="${src}">
				<include name="dr/**/*.png" />
				<include name="org/virion/jam/**/*.png" />
				<include name="dr/**/*.properties" />
			</fileset>
			<zipgroupfileset dir="${lib}" includes="jebl.jar" />
			<zipgroupfileset dir="${lib}" includes="jdom.jar" />
			<zipgroupfileset dir="${lib}" includes="beagle.jar" />
			<zipgroupfileset dir="${lib}" includes="commons-math-1.2.jar" />
			<zipgroupfileset dir="${lib}" includes="mtj.jar" />
			<zipgroupfileset dir="${lib}" includes="JRI.jar" />
			<zipgroupfileset dir="${lib}" includes="colt.jar" />
		</jar>
	</target>
	
	<target name="run_tool">
		<java jar="${dist}/treeannotator.jar" fork="true" />
	</target>
	
</project>
